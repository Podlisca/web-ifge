



<style>
    .body-blackout {
        position: fixed;
        z-index: 1010;
        left: 0;
        top: 0;
        width: 100%;
        height: 100%;
        background-color: rgba(0, 0, 0, .65);
        display: none;
    }

    .body-blackout.is-blacked-out {
        display: block;
    }

    .popup-trigger {
        display: inline-block;
    }

    .popup-modal {
        max-width: 100%;
        background-color: #fff;
        position: fixed;
        left: 50%;
        top: 50%;
        transform: translate(-50%, -50%);
        padding: 45px;
        opacity: 0;
        pointer-events: none;
        transition: all 300ms ease-in-out;
        z-index: 1011;
    }

    .popup-modal.is--visible {
        opacity: 1;
        pointer-events: auto;
    }

    .popup-modal.__close {
        position: absolute;
        font-size: 1.2rem;
        right: -10px;
        top: -10px;
        cursor: pointer;
    }
</style>

<div class="body-blackout"></div>

<div class="popup-modal shadow" data-popup-modal="subscribe">
    <i class="fas fa-2x fa-times text-white bg-primary p-3 popup-modal__close"></i>
    <div class="popup-modal-body">
        <h1 class="font-weight-bold">
            Subscribe
        </h1>
        <form action="https://newsletter.cors.online/subscribe" method="POST" accept-charset="utf-8">
        <label for="name">Name</label><br />
        <input type="text" name="name" id="name" />
        <br />
        <label for="email">Email</label><br />
        <input type="email" name="email" id="email" />    
        <div style="display:none;">
            <label for="hp">HP</label><br />
            <input type="text" name="hp" id="hp" />
        </div>
        <input type="hidden" name="list" value="W88923wbLV9C5rSZYi8GvwPA" />
        <input type="hidden" name="subform" value="yes" />
        <input type="submit" name="submit" id="submit" />
    </div>
</form>
</div>

<div id="subscribe"
    style="display: none; position: absolute; z-index: 199; background-color: blue; top: 0; left: 0; right: 0; bottom: 0;">
    Some content
    <button onclick="subscribe()">Subscribe!</button>
</div>

<script>

    function subscribe() {
        let formData = new FormData();
        formData.append("name", "The name");
        formData.append("email", "email@asdmi.email");
        formData.append("list", "9Sn892ft7KSR6RVRa0In6uNQ");
        formData.append("subform", "yes");

        fetch("https://sendy.cors.online/subscribe", {
            method: "POST",
            body: formData
        }).then(res => {
            console.log("Request complete! response:", res);
        });
    }

    function showSubscribeForm() {
        document.getElementById("subscribe").style.display = "block";

    }

    const modalTriggers = document.querySelectorAll('.popup-trigger')
    const modalCloseTrigger = document.querySelector('.popup-modal__close')
    const bodyBlackout = document.querySelector('.body-blackout')

    modalTriggers.forEach(trigger => {
        trigger.addEventListener('click', () => {
            const { popupTrigger } = trigger.dataset
            const popupModal = document.querySelector(`[data-popup-modal="${popupTrigger}"]`)

            popupModal.classList.add('is--visible')
            bodyBlackout.classList.add('is-blacked-out')

            popupModal.querySelector('.popup-modal__close').addEventListener('click', () => {
                popupModal.classList.remove('is--visible')
                bodyBlackout.classList.remove('is-blacked-out')
            })

            bodyBlackout.addEventListener('click', () => {
                // TODO: Turn into a function to close modal
                popupModal.classList.remove('is--visible')
                bodyBlackout.classList.remove('is-blacked-out')
            })
        })
    })

</script>